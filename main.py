import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST =['https://www.facebook.com/61554283290887/', 'https://www.facebook.com/61554724839551/', 'https://www.facebook.com/61554791003282/', 'https://www.facebook.com/61555028368318/', 'https://www.facebook.com/61555200534707/', 'https://www.facebook.com/61555282029379/', 'https://www.facebook.com/61555353029247/', 'https://www.facebook.com/61555548755852/', 'https://www.facebook.com/61555678276729/', 'https://www.facebook.com/61555693793109/', 'https://www.facebook.com/61555715499302/', 'https://www.facebook.com/61555841797697/', 'https://www.facebook.com/61555880762813/', 'https://www.facebook.com/61555933596203/', 'https://www.facebook.com/61556010467366/', 'https://www.facebook.com/61556096916243/', 'https://www.facebook.com/61556117639520/', 'https://www.facebook.com/61556139870962/', 'https://www.facebook.com/61556172257937/', 'https://www.facebook.com/61556229433787/', 'https://www.facebook.com/61556299667755/', 'https://www.facebook.com/61556312578384/', 'https://www.facebook.com/61556404928593/', 'https://www.facebook.com/61556652311217/', 'https://www.facebook.com/61556686781301/', 'https://www.facebook.com/61556807221488/', 'https://www.facebook.com/61556991117029/', 'https://www.facebook.com/61557747585920/', 'https://www.facebook.com/61557842445218/', 'https://www.facebook.com/61558475546656/', 'https://www.facebook.com/61558763026646/', 'https://www.facebook.com/61559043265766/', 'https://www.facebook.com/61559060816378/', 'https://www.facebook.com/61559089393293/', 'https://www.facebook.com/61559127137503/', 'https://www.facebook.com/61559276106256/', 'https://www.facebook.com/61559376221309/', 'https://www.facebook.com/61559781326559/', 'https://www.facebook.com/61559940249523/', 'https://www.facebook.com/61560028820023/', 'https://www.facebook.com/61560049722480/', 'https://www.facebook.com/61560083033278/', 'https://www.facebook.com/61560182945600/', 'https://www.facebook.com/61560248643802/', 'https://www.facebook.com/61560278030910/', 'https://www.facebook.com/61560315043687/', 'https://www.facebook.com/61560326234961/', 'https://www.facebook.com/61560368626302/', 'https://www.facebook.com/61560468376149/', 'https://www.facebook.com/61560511382232/', 'https://www.facebook.com/61560545189823/', 'https://www.facebook.com/61560681815739/', 'https://www.facebook.com/61560696752819/', 'https://www.facebook.com/61560703596304/', 'https://www.facebook.com/61560723993024/', 'https://www.facebook.com/61560746457520/', 'https://www.facebook.com/61560852887406/', 'https://www.facebook.com/61560929066642/', 'https://www.facebook.com/61560935767851/', 'https://www.facebook.com/61561150905073/', 'https://www.facebook.com/61561164546631/', 'https://www.facebook.com/61561168434174/', 'https://www.facebook.com/61561196398977/', 'https://www.facebook.com/61561209413619/', 'https://www.facebook.com/61561243286691/', 'https://www.facebook.com/61561499053093/', 'https://www.facebook.com/61561532347273/', 'https://www.facebook.com/61561653462470/', 'https://www.facebook.com/61561711681943/', 'https://www.facebook.com/61561764448364/', 'https://www.facebook.com/61561863885644/', 'https://www.facebook.com/61562273897259/', 'https://www.facebook.com/61562369401522/', 'https://www.facebook.com/61562432177183/', 'https://www.facebook.com/61562753647667/', 'https://www.facebook.com/61563056917041/', 'https://www.facebook.com/61563210940674/', 'https://www.facebook.com/61563285429032/', 'https://www.facebook.com/61563388804822/', 'https://www.facebook.com/61563444669183/', 'https://www.facebook.com/61563563911662/', 'https://www.facebook.com/61563576450198/', 'https://www.facebook.com/61563594794842/', 'https://www.facebook.com/61563763947962/', 'https://www.facebook.com/61563938226552/', 'https://www.facebook.com/61564269433853/', 'https://www.facebook.com/61564397812637/', 'https://www.facebook.com/61564464677804/', 'https://www.facebook.com/61564570383633/', 'https://www.facebook.com/61564646761185/', 'https://www.facebook.com/61564850267756/', 'https://www.facebook.com/61565081429524/', 'https://www.facebook.com/61565317722190/', 'https://www.facebook.com/61565408137582/', 'https://www.facebook.com/61565428545898/', 'https://www.facebook.com/61565431843481/', 'https://www.facebook.com/61565519407672/', 'https://www.facebook.com/61565743193585/', 'https://www.facebook.com/61565760616794/', 'https://www.facebook.com/61565820926509/', 'https://www.facebook.com/61565942430573/', 'https://www.facebook.com/61565985538023/', 'https://www.facebook.com/61566027822044/', 'https://www.facebook.com/61566126523657/', 'https://www.facebook.com/61566370890996/', 'https://www.facebook.com/61566392639394/', 'https://www.facebook.com/61566450875714/', 'https://www.facebook.com/61566464680007/', 'https://www.facebook.com/61566472046659/', 'https://www.facebook.com/61566513175860/', 'https://www.facebook.com/61566545644622/', 'https://www.facebook.com/61566556123836/', 'https://www.facebook.com/61566799287186/', 'https://www.facebook.com/61566992587362/', 'https://www.facebook.com/61567060394674/', 'https://www.facebook.com/61567125104813/', 'https://www.facebook.com/61567206056559/', 'https://www.facebook.com/61567213252816/', 'https://www.facebook.com/61567258558430/', 'https://www.facebook.com/61567332834527/', 'https://www.facebook.com/61567362569534/', 'https://www.facebook.com/61567368726420/', 'https://www.facebook.com/61567383977309/', 'https://www.facebook.com/61567477302743/', 'https://www.facebook.com/61567536971847/', 'https://www.facebook.com/61567553710592/', 'https://www.facebook.com/61567697190485/', 'https://www.facebook.com/61567765963556/', 'https://www.facebook.com/61567788785413/', 'https://www.facebook.com/61568317992544/', 'https://www.facebook.com/61568439245446/', 'https://www.facebook.com/61568587012781/', 'https://www.facebook.com/61568643445618/', 'https://www.facebook.com/61568656836879/', 'https://www.facebook.com/61568774762742/', 'https://www.facebook.com/61568840759097/', 'https://www.facebook.com/61569038973721/', 'https://www.facebook.com/61569284132674/', 'https://www.facebook.com/61569496037510/', 'https://www.facebook.com/61569604153182/', 'https://www.facebook.com/61569702687575/', 'https://www.facebook.com/61569798217451/', 'https://www.facebook.com/61569827630318/', 'https://www.facebook.com/61569961321415/', 'https://www.facebook.com/61570202554793/', 'https://www.facebook.com/61570486616690/', 'https://www.facebook.com/61570514445363/', 'https://www.facebook.com/61570528365906/', 'https://www.facebook.com/61570736519987/', 'https://www.facebook.com/61570855827378/', 'https://www.facebook.com/61570857998887/', 'https://www.facebook.com/61570914760360/', 'https://www.facebook.com/61571121074504/', 'https://www.facebook.com/61571237623915/', 'https://www.facebook.com/61571301634205/', 'https://www.facebook.com/61571312276274/', 'https://www.facebook.com/61571432546825/', 'https://www.facebook.com/61571442385313/', 'https://www.facebook.com/61571461979404/', 'https://www.facebook.com/61571500005326/', 'https://www.facebook.com/61571516920567/', 'https://www.facebook.com/61571524795612/', 'https://www.facebook.com/61571564045231/', 'https://www.facebook.com/61571580816485/', 'https://www.facebook.com/61571661063783/', 'https://www.facebook.com/61571668985985/', 'https://www.facebook.com/61571845569183/', 'https://www.facebook.com/61571878477739/', 'https://www.facebook.com/61571922936053/', 'https://www.facebook.com/61572014121223/', 'https://www.facebook.com/61572389440191/', 'https://www.facebook.com/61572404284224/', 'https://www.facebook.com/61572405594887/', 'https://www.facebook.com/61572422596510/', 'https://www.facebook.com/61572464842229/', 'https://www.facebook.com/61572513190604/', 'https://www.facebook.com/61572521987730/', 'https://www.facebook.com/61572565511263/', 'https://www.facebook.com/61572576982933/', 'https://www.facebook.com/61572604474307/', 'https://www.facebook.com/61572606223827/', 'https://www.facebook.com/61572627392619/', 'https://www.facebook.com/61572630904606/', 'https://www.facebook.com/61572693461199/', 'https://www.facebook.com/61572920595653/', 'https://www.facebook.com/61572956501882/', 'https://www.facebook.com/61573046751337/', 'https://www.facebook.com/61573064246365/', 'https://www.facebook.com/61573078952778/', 'https://www.facebook.com/61573201885974/', 'https://www.facebook.com/61573396913215/', 'https://www.facebook.com/61573398189940/', 'https://www.facebook.com/61573454206649/', 'https://www.facebook.com/61573489951314/', 'https://www.facebook.com/61573505593924/', 'https://www.facebook.com/61573522432225/', 'https://www.facebook.com/61573564383079/', 'https://www.facebook.com/61573600814750/', 'https://www.facebook.com/61573696239435/', 'https://www.facebook.com/61573704475569/', 'https://www.facebook.com/61573738533773/', 'https://www.facebook.com/61573781934868/', 'https://www.facebook.com/61573817923908/', 'https://www.facebook.com/61573828503850/', 'https://www.facebook.com/61573831323820/', 'https://www.facebook.com/61573862265579/', 'https://www.facebook.com/61573880499943/', 'https://www.facebook.com/61573907811117/', 'https://www.facebook.com/61573962538315/', 'https://www.facebook.com/61574007016862/', 'https://www.facebook.com/61574011716979/', 'https://www.facebook.com/61574012227186/', 'https://www.facebook.com/61574015907810/', 'https://www.facebook.com/61574068743888/', 'https://www.facebook.com/61574075440355/', 'https://www.facebook.com/61574110643561/', 'https://www.facebook.com/61574148510133/', 'https://www.facebook.com/61574152816624/', 'https://www.facebook.com/61574258191418/', 'https://www.facebook.com/61574274441376/', 'https://www.facebook.com/61574344103747/', 'https://www.facebook.com/61574356151301/', 'https://www.facebook.com/61574357792051/', 'https://www.facebook.com/61574411130883/', 'https://www.facebook.com/61574417911326/', 'https://www.facebook.com/61574457641848/', 'https://www.facebook.com/61574472639765/', 'https://www.facebook.com/61574479090473/', 'https://www.facebook.com/61574500711757/', 'https://www.facebook.com/61574526516432/', 'https://www.facebook.com/61574528416875/', 'https://www.facebook.com/61574529975634/', 'https://www.facebook.com/61574533936662/', 'https://www.facebook.com/61574549621900/', 'https://www.facebook.com/61574551300571/', 'https://www.facebook.com/61574555255328/', 'https://www.facebook.com/61574556053752/', 'https://www.facebook.com/61574559411974/', 'https://www.facebook.com/61574563924960/', 'https://www.facebook.com/61574579686071/', 'https://www.facebook.com/61574580311837/', 'https://www.facebook.com/61574584603702/', 'https://www.facebook.com/61574590899078/', 'https://www.facebook.com/61574596523930/', 'https://www.facebook.com/61574598907172/', 'https://www.facebook.com/61574608995427/', 'https://www.facebook.com/61574612607486/', 'https://www.facebook.com/61574617695677/', 'https://www.facebook.com/61574657150856/', 'https://www.facebook.com/61574688582340/', 'https://www.facebook.com/61574702684634/', 'https://www.facebook.com/61574736938176/', 'https://www.facebook.com/61574738686204/', 'https://www.facebook.com/61574766162469/', 'https://www.facebook.com/61574791404822/', 'https://www.facebook.com/61574815892144/', 'https://www.facebook.com/61574831350787/', 'https://www.facebook.com/61574842207528/', 'https://www.facebook.com/61574852133829/', 'https://www.facebook.com/61574856548599/', 'https://www.facebook.com/61574860630178/', 'https://www.facebook.com/61574870403416/', 'https://www.facebook.com/61574875203982/', 'https://www.facebook.com/61574886659157/', 'https://www.facebook.com/61574910209340/', 'https://www.facebook.com/61574926464655/', 'https://www.facebook.com/61574940507748/', 'https://www.facebook.com/61574974022837/', 'https://www.facebook.com/61574998410236/', 'https://www.facebook.com/61575014879874/', 'https://www.facebook.com/61575022320264/', 'https://www.facebook.com/61575038401773/', 'https://www.facebook.com/61575059220424/', 'https://www.facebook.com/61575071878844/', 'https://www.facebook.com/61575077150628/', 'https://www.facebook.com/61575101428462/', 'https://www.facebook.com/61575105862366/', 'https://www.facebook.com/61575124194845/', 'https://www.facebook.com/61575129351569/', 'https://www.facebook.com/61575177233247/', 'https://www.facebook.com/61575221992191/', 'https://www.facebook.com/635830149606951', 'https://www.facebook.com/99GraphicsDesign/', 'https://www.facebook.com/AdAgencyDesign/', 'https://www.facebook.com/Adroitinfoactiveservices/', 'https://www.facebook.com/AdvancedGrohairClinicCamacStreet/', 'https://www.facebook.com/AkDENAR-558010737401593/', 'https://www.facebook.com/Allsolutionmediaa/', 'https://www.facebook.com/AnudipFoundation/', 'https://www.facebook.com/Arhaan-Ahmed-106032282055047/', 'https://www.facebook.com/ArihantRaajesh/', 'https://www.facebook.com/AspireTechnosysPvtLtd/', 'https://www.facebook.com/Astrologer9527/', 'https://www.facebook.com/AvinewsInternational/', 'https://www.facebook.com/Avneet-Singh-589647267558823/', 'https://www.facebook.com/Azeeziamedicationcenter/', 'https://www.facebook.com/Beatravelbuddy/', 'https://www.facebook.com/BismillahTravelsUsa/', 'https://www.facebook.com/BrandMedix/', 'https://www.facebook.com/Brigadejobscbe/', 'https://www.facebook.com/Call-Digital-Fire-Marketing-Agency-In-india-112892575197608/', 'https://www.facebook.com/ChaitanyaParamedicalCG/', 'https://www.facebook.com/Cipacaofficial/', 'https://www.facebook.com/Credential-584059781463908/', 'https://www.facebook.com/Cybees.official/', 'https://www.facebook.com/DAMAN.PAYAL/', 'https://www.facebook.com/Dhanlaxmi-Multiservices-611170188747365/', 'https://www.facebook.com/DigitaliPage/', 'https://www.facebook.com/Diivinemagician/', 'https://www.facebook.com/DolphinBusinessCentre/', 'https://www.facebook.com/DrTonyNader/', 'https://www.facebook.com/EasierInfluencerMarketing/', 'https://www.facebook.com/EasiestOverseas2022/', 'https://www.facebook.com/FZCSB/', 'https://www.facebook.com/FlykontinentTravelAgency/', 'https://www.facebook.com/Fyerx/', 'https://www.facebook.com/GJIMTMOHALICAMPUS/', 'https://www.facebook.com/GroupGsales/', 'https://www.facebook.com/Gtatourandtravel/', 'https://www.facebook.com/HVAC.MEP.Skill.Training/', 'https://www.facebook.com/Habits365Club/', 'https://www.facebook.com/Handpanarama/', 'https://www.facebook.com/HarmonyDomes/', 'https://www.facebook.com/Himalayan.Helicopter.Travel.Tours/', 'https://www.facebook.com/HindustanHyundaiJaipur/', 'https://www.facebook.com/HomeFlair.in/', 'https://www.facebook.com/ISBeduOnline/', 'https://www.facebook.com/Improveclients/', 'https://www.facebook.com/IndiaKolkataCity/', 'https://www.facebook.com/KanhaHandicraftFurnitures/', 'https://www.facebook.com/LoveGiftBrindes/', 'https://www.facebook.com/MMCHYDERABAD/', 'https://www.facebook.com/MVNFMS/', 'https://www.facebook.com/Magtapp/', 'https://www.facebook.com/MammthaShah207/', 'https://www.facebook.com/Mashinottam/', 'https://www.facebook.com/MethodWave/', 'https://www.facebook.com/Mithuscakeclub/', 'https://www.facebook.com/MultiedgeSolution/', 'https://www.facebook.com/Myonline360/', 'https://www.facebook.com/NIMSUniv/', 'https://www.facebook.com/Nextbigbox/', 'https://www.facebook.com/Nexumeducation/', 'https://www.facebook.com/NumerologyCrystalVisions/', 'https://www.facebook.com/NurturingCubsOfficial/', 'https://www.facebook.com/OMXTechnologiesPune/', 'https://www.facebook.com/OfficialMehtaWebsolution/', 'https://www.facebook.com/OrganicTheatre/', 'https://www.facebook.com/PATHIK2589/', 'https://www.facebook.com/Pansuriya-Pradip-548348328372102/', 'https://www.facebook.com/PopularMarutiBengaluru/', 'https://www.facebook.com/PopularNexa/', 'https://www.facebook.com/PriyaTravls/', 'https://www.facebook.com/Qnex.in/', 'https://www.facebook.com/Quipair/', 'https://www.facebook.com/RadhakrishnaFinance/', 'https://www.facebook.com/Ratna.International.official/', 'https://www.facebook.com/Rohitinkar007/', 'https://www.facebook.com/RoyalGrowthMarketing/', 'https://www.facebook.com/RudranshComputer/', 'https://www.facebook.com/SLBCMain/', 'https://www.facebook.com/SSNumeroo/', 'https://www.facebook.com/SampuranDivineNumerology/', 'https://www.facebook.com/Sannidhyabaweja/', 'https://www.facebook.com/Shonika-Rising-Medical-Health-Institution-109238168797388/', 'https://www.facebook.com/ShreeBalvatikaPreSchool/', 'https://www.facebook.com/Shreyachoudhury710/', 'https://www.facebook.com/Silvercanvasanimationstudioacademy/', 'https://www.facebook.com/SkillBlazeAI/', 'https://www.facebook.com/SocialMediaHandling/', 'https://www.facebook.com/Socialite.official/', 'https://www.facebook.com/Soundkraftindia/', 'https://www.facebook.com/Staffspectrum/', 'https://www.facebook.com/TMCmobileTechnology/', 'https://www.facebook.com/TNservicesOfficial/', 'https://www.facebook.com/TalkingPowers/', 'https://www.facebook.com/TdotKPakistan/', 'https://www.facebook.com/TheOfficialIDA/', 'https://www.facebook.com/TheTeaserCompany/', 'https://www.facebook.com/TheVedicaScholarsProgrammeforWomen/', 'https://www.facebook.com/Tidesclt/', 'https://www.facebook.com/TraviYo/', 'https://www.facebook.com/VASANTHAM-COMMUNITY-COLLEGE-304986489371449/', 'https://www.facebook.com/ValeriVisuals/', 'https://www.facebook.com/VrindaTechapps/', 'https://www.facebook.com/WatermelonMediaTech/', 'https://www.facebook.com/WebDSchool/', 'https://www.facebook.com/WebLinkServicesPvtLtd/', 'https://www.facebook.com/Werankone/', 'https://www.facebook.com/WybhavBhatnagarAstrology/', 'https://www.facebook.com/YogaFarmIthaca/', 'https://www.facebook.com/ZEONACADEMY/', 'https://www.facebook.com/aashishyogii/', 'https://www.facebook.com/accuwisetechdelhi/', 'https://www.facebook.com/acharyajoshiji3111/', 'https://www.facebook.com/acharyaujjalsastri/', 'https://www.facebook.com/adbissdigitalmarketing/', 'https://www.facebook.com/adda247live/', 'https://www.facebook.com/adiyogaashram/', 'https://www.facebook.com/adprovizeinfotech/', 'https://www.facebook.com/adroitimmigrationservice/', 'https://www.facebook.com/advert360Solution/', 'https://www.facebook.com/advertaura/', 'https://www.facebook.com/alexandria.crow/', 'https://www.facebook.com/alfatechmaduraii/', 'https://www.facebook.com/alphagened/', 'https://www.facebook.com/amzsalesmachine/', 'https://www.facebook.com/andamanexcursiontravels/', 'https://www.facebook.com/anileeanimation/', 'https://www.facebook.com/anytimeastro/', 'https://www.facebook.com/aptsokerala/', 'https://www.facebook.com/artleaguestudio/', 'https://www.facebook.com/askhealthcarenallalam/', 'https://www.facebook.com/astrologerketanjoshi/', 'https://www.facebook.com/astrologerneerajdiwan/', 'https://www.facebook.com/astroparveensharma/', 'https://www.facebook.com/astrosrivastava/', 'https://www.facebook.com/astroujjalsastri/', 'https://www.facebook.com/avivdigital/', 'https://www.facebook.com/avtaryogludhiana/', 'https://www.facebook.com/badiyabrand/', 'https://www.facebook.com/beinsomniacs/', 'https://www.facebook.com/bemaxacademy/', 'https://www.facebook.com/bepositivetwentyfour/', 'https://www.facebook.com/beyondextremes379/', 'https://www.facebook.com/bharatacrepair/', 'https://www.facebook.com/bharatkadistributor/', 'https://www.facebook.com/blessingtrip.co/', 'https://www.facebook.com/bookingkaralo/', 'https://www.facebook.com/branddadindia/', 'https://www.facebook.com/brandflex.business/', 'https://www.facebook.com/brightmoontravel1/', 'https://www.facebook.com/brikkin.in/', 'https://www.facebook.com/cac.abq/', 'https://www.facebook.com/cajayminbhatis/', 'https://www.facebook.com/capeducational/', 'https://www.facebook.com/carstudiomohali/', 'https://www.facebook.com/cavitakmarketing/', 'https://www.facebook.com/chalotravellers/', 'https://www.facebook.com/chintpurniyogkendra/', 'https://www.facebook.com/columbiadang/', 'https://www.facebook.com/connectwithdizi/', 'https://www.facebook.com/createbytes/', 'https://www.facebook.com/designhost01/', 'https://www.facebook.com/designsandwordsjaipur/', 'https://www.facebook.com/digiaccel.learning/', 'https://www.facebook.com/digiaerotech/', 'https://www.facebook.com/digitalpratik/', 'https://www.facebook.com/digitalraiz/', 'https://www.facebook.com/digitalscholarindia/', 'https://www.facebook.com/digitalwinacademics/', 'https://www.facebook.com/digixbranding/', 'https://www.facebook.com/divinemeditation.org/', 'https://www.facebook.com/dolphininterviewcampus', 'https://www.facebook.com/drahomesindia/', 'https://www.facebook.com/dreaminternationaltravelagency/', 'https://www.facebook.com/drlamaayurveda/', 'https://www.facebook.com/dvcgurukulam/', 'https://www.facebook.com/dwtt.travel/', 'https://www.facebook.com/easyadswithadoll/', 'https://www.facebook.com/ecare.upskill/', 'https://www.facebook.com/ecliqs/', 'https://www.facebook.com/ecommercechecklist/', 'https://www.facebook.com/emptypocketsproduction.official/', 'https://www.facebook.com/enlightenmonks/', 'https://www.facebook.com/eskyoverseashr/']

phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
